<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
  <div
    id="loading_loading"
    style="
      width: 100%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      font-size: 40px;
      background: #9f9f9f;
      color: #fff;
    "
  >
    我是传说中的骨架屏幕
  </div>
  <div id="root"></div>
  <script>
    // 阻止刷新页面 以及 删除页面
    window.__IS__START__REFRESH__ = true;
    window.__stopRefresh__ = function () {
      window.__IS__START__REFRESH__ = false;
      console.log(' ----   开启 禁止刷新模式   ---- ');
      // 删除
//      window.addEventListener('unload', __onUnloadFun);

      // 阻止用户卸载页面
      window.addEventListener('beforeunload', __onBeforeunLoadFun);

      // 后退
      window.history.pushState(null, '#', document.URL);
      window.addEventListener('popstate', __onPopstateFun);
    };

//    function __onUnloadFun() {
//      var dialogText = 'Dialog text here 1';
//      e.returnValue = dialogText;
//      return dialogText;
//    }

    function __onBeforeunLoadFun(e) {
      var dialogText = 'Dialog text here 1';
      e.returnValue = dialogText;
      return dialogText;
    }

    function __onPopstateFun() {
      window.history.pushState(null, '#', document.URL);
    }

    // 当已经保存时移除这写事件
    window.__clearRefreshClick__ = function () {
//      window.removeEventListener('unload', __onUnloadFun);
      window.removeEventListener('beforeunload', __onBeforeunLoadFun);
      window.removeEventListener('beforeunload', __onPopstateFun);
    }
  </script>
</body>
</html>
